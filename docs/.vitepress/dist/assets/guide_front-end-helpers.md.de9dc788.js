import{_ as e,o as s,c as a,$ as t}from"./chunks/framework.9fa1e75e.js";const D=JSON.parse('{"title":"Front end helper methods","description":"","frontmatter":{"prev":{"text":"Front end code tips","link":"guide/front-end-tips.md"},"next":{"text":"Nested module folders","link":"guide/nested-module-subdirs.md"}},"headers":[],"relativePath":"guide/front-end-helpers.md","filePath":"guide/front-end-helpers.md","lastUpdated":1690289066000}'),o={name:"guide/front-end-helpers.md"},n=t(`<h1 id="front-end-helper-methods" tabindex="-1">Front end helper methods <a class="header-anchor" href="#front-end-helper-methods" aria-label="Permalink to &quot;Front end helper methods&quot;">​</a></h1><p>Apostrophe provides a small library of front-end utility methods to support implementing client-side JavaScript. These can be useful in widget players, for example. <a href="#general-utility-methods">General utility methods</a> area available on <code>apos.util</code> and <a href="#http-request-methods">HTTP request methods</a> are available on <code>apos.http</code>.</p><h2 id="general-utility-methods" tabindex="-1">General utility methods <a class="header-anchor" href="#general-utility-methods" aria-label="Permalink to &quot;General utility methods&quot;">​</a></h2><p>These are all available in the browser on <code>apos.util</code>, e.g., <code>apos.util.addClass(el, &#39;is-active&#39;)</code>. They include wrappers for common browser APIs, classic DOM traversal methods, and Apostrophe-specific utilities. They are also compatible with all modern browsers as well as Internet Explorer 11.</p><table><thead><tr><th>Method</th><th>What is it?</th></tr></thead><tbody><tr><td><a href="#addclass-el-classname"><code>addClass</code></a></td><td>Add a class to a DOM element, if missing.</td></tr><tr><td><a href="#assign-target-src1-src2"><code>assign</code></a></td><td>Assigns properties from one or more source objects to a target object.</td></tr><tr><td><a href="#attachmenturl-fileobj-options"><code>attachmentUrl</code></a></td><td>Get the file URL for an Apostrophe attachment object.</td></tr><tr><td><a href="#closest-el-selector"><code>closest</code></a></td><td>Returns the closest ancestor element that matches the selector.</td></tr><tr><td><a href="#emit-el-name-data"><code>emit</code></a></td><td>Emit a custom browser event on a DOM element.</td></tr><tr><td><a href="#getcookie-name"><code>getCookie</code></a></td><td>Get the value of a browser cookie.</td></tr><tr><td><a href="#onready-fn"><code>onReady</code></a></td><td>Runs the function passed in when Apostrophe refreshes page content during editing.</td></tr><tr><td><a href="#removeclass-el-classname"><code>removeClass</code></a></td><td>Remove a class from a DOM element, if present.</td></tr><tr><td><a href="#samesite-uri"><code>sameSite</code></a></td><td>Returns <code>true</code> if a URI argument matches the same website as the current page.</td></tr></tbody></table><h3 id="addclass-el-classname" tabindex="-1"><code>addClass(el, className)</code> <a class="header-anchor" href="#addclass-el-classname" aria-label="Permalink to &quot;\`addClass(el, className)\`&quot;">​</a></h3><p>Add a class to a DOM element, if missing. Often used with <a href="#removeclass-el-classname"><code>removeClass</code></a>. Supports browsers without the matching native method.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>el</code></td><td>a DOM element</td></tr><tr><td><code>className</code></td><td>a string to be added to the <code>class</code> attribute</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> myElement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-my-element]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addClass</span><span style="color:#A6ACCD;">(myElement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">is-active</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="assign-target-src1-src2" tabindex="-1"><code>assign(target, src1, src2, ...)</code> <a class="header-anchor" href="#assign-target-src1-src2" aria-label="Permalink to &quot;\`assign(target, src1, src2, ...)\`&quot;">​</a></h3><p>Assigns properties from one or more source objects to a target object. Uses <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign" target="_blank" rel="noreferrer"><code>Object.assign</code></a> when available. Supports browsers without the matching native method.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>target</code></td><td>an object on which to add source object properties</td></tr><tr><td><code>src1</code>, <code>src2</code>, etc.</td><td>one or more source objects whose properties should copy to the target object</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> options </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">name</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">balloon</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">blue</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">assign</span><span style="color:#A6ACCD;">(options</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">red</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">language</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">French</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(options)</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// {</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//   name: &#39;balloon&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//   color: &#39;red&#39;,</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//   language: &#39;French&#39;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// }</span></span></code></pre></div><h3 id="attachmenturl-fileobj-options" tabindex="-1"><code>attachmentUrl(fileObj, options)</code> <a class="header-anchor" href="#attachmenturl-fileobj-options" aria-label="Permalink to &quot;\`attachmentUrl(fileObj, options)\`&quot;">​</a></h3><p>Get the file URL for an Apostrophe attachment object. Optionally pass an options object to get a specific version of the file. File (non-image) attachment objects include a single <code>_url</code> property already, so this is primarily used for retrieving specific versions of an image.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>fileObj</code></td><td>an attachment object, such as from an attachment field value or using a template helper method to parse an <a href="/guide/core-widgets.html#image-widget">image widget</a> value</td></tr><tr><td><code>options</code></td><td>image options to apply for the resulting URL</td></tr></tbody></table><table><thead><tr><th>Options</th><th>What is it?</th></tr></thead><tbody><tr><td><code>size</code></td><td>an image size name to retrieve, such as one of the <a href="/guide/core-widgets.html#specifying-the-fallback-size">standard image file variations</a></td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// Getting an image attachment object after stashing the stringified object</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// on a \`data-image\` attribute in the template</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> imageObj </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-thumbnail]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">dataset</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">image</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> smallImage </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">attachmentUrl</span><span style="color:#A6ACCD;">(imageObj</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">size</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">one-third</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="closest-el-selector" tabindex="-1"><code>closest(el, selector)</code> <a class="header-anchor" href="#closest-el-selector" aria-label="Permalink to &quot;\`closest(el, selector)\`&quot;">​</a></h3><p>Returns the closest ancestor element that matches the selector. The element itself is considered the closest possible match. Supports browsers without the matching native method.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>el</code></td><td>a DOM element</td></tr><tr><td><code>selector</code></td><td>a string to use as a CSS selector to match</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> menuToggle </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-toggle]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> menu </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">closest</span><span style="color:#A6ACCD;">(myElement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-menu]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="emit-el-name-data" tabindex="-1"><code>emit(el, name, data)</code> <a class="header-anchor" href="#emit-el-name-data" aria-label="Permalink to &quot;\`emit(el, name, data)\`&quot;">​</a></h3><p>Emit a custom browser event on a DOM element. Optionally include a <code>data</code> object to include on the event. For event listeners, use the standard browser <a href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" target="_blank" rel="noreferrer"><code>addEventListener</code> method</a>.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>el</code></td><td>a DOM element</td></tr><tr><td><code>name</code></td><td>a string to use as the event name</td></tr><tr><td><code>data</code></td><td>(optional) an object containing data to include on the event object</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> myElement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-my-element]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">emit</span><span style="color:#A6ACCD;">(myElement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">openChat</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="getcookie-name" tabindex="-1"><code>getCookie(name)</code> <a class="header-anchor" href="#getcookie-name" aria-label="Permalink to &quot;\`getCookie(name)\`&quot;">​</a></h3><p>Get the value of a browser cookie.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>name</code></td><td>The name of a browser cookie</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getCookie</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">cookiename</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="onready-fn" tabindex="-1"><code>onReady(fn)</code> <a class="header-anchor" href="#onready-fn" aria-label="Permalink to &quot;\`onReady(fn)\`&quot;">​</a></h3><p>Runs the function passed in when the page loads as well as when Apostrophe refreshes page content during editing. When logged out it will run the function on initial page load. This is not necessary in <a href="/guide/custom-widgets.html#client-side-javascript-for-widgets">widget players</a>.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p>This method was previously named <code>onReadyAndRefresh</code>. The name was changed, though the previous name will still work through the 3.x major version.</p></div><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>fn</code></td><td>a function that should run when page content is ready</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> loadNewsletterForm </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// Code that loads a sign-up form...</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onReady</span><span style="color:#A6ACCD;">(loadNewsletterForm)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="removeclass-el-classname" tabindex="-1"><code>removeClass(el, className)</code> <a class="header-anchor" href="#removeclass-el-classname" aria-label="Permalink to &quot;\`removeClass(el, className)\`&quot;">​</a></h3><p>Remove a class from a DOM element, if present. Often used with <a href="#addclass-el-classname"><code>addClass</code></a>. Supports browsers without the matching native method.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>el</code></td><td>a DOM element</td></tr><tr><td><code>className</code></td><td>a string to be added to the <code>class</code> attribute</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> myElement </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">querySelector</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">[data-my-element]</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">removeClass</span><span style="color:#A6ACCD;">(myElement</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">is-hidden</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="samesite-uri" tabindex="-1"><code>sameSite(uri)</code> <a class="header-anchor" href="#samesite-uri" aria-label="Permalink to &quot;\`sameSite(uri)\`&quot;">​</a></h3><p>Returns <code>true</code> if the URI pass in matches the same website (same host and port) as the current page. This is used in some HTTP utility methods.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>uri</code></td><td>a valid URI</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> targetUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">https://some-website.rocks/api/gems</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> siteMatches </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">util</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">sameSite</span><span style="color:#A6ACCD;">(targetUrl)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p>There is also a <code>runPlayers</code> method on <code>apos.util</code>. That is run for us using <code>apos.util.onReady</code> and runs all registered widget players. It is unlikely that it will need to be run in project-level code.</p></div><h2 id="http-request-methods" tabindex="-1">HTTP request methods <a class="header-anchor" href="#http-request-methods" aria-label="Permalink to &quot;HTTP request methods&quot;">​</a></h2><p>These are all available in the browser on <code>apos.http</code>, e.g., <code>apos.http.get(&#39;/api/v1/article&#39;)</code>. They include utility methods to make requests with each HTTP method (<code>GET</code>, <code>POST</code>, <code>PATCH</code>, <code>PUT</code>, and <code>DELETE</code>) as well as other helpers for making HTTP requests.</p><table><thead><tr><th>Method</th><th>What is it?</th></tr></thead><tbody><tr><td><a href="#get-url-options-callback"><code>get</code></a></td><td>Send a <code>GET</code> request.</td></tr><tr><td><a href="#post-url-options-callback"><code>post</code></a></td><td>Send a <code>POST</code> request.</td></tr><tr><td><a href="#patch-url-options-callback"><code>patch</code></a></td><td>Send a <code>PATCH</code> request.</td></tr><tr><td><a href="#put-url-options-callback"><code>put</code></a></td><td>Send a <code>PUT</code> request.</td></tr><tr><td><a href="#delete-url-options-callback"><code>delete</code></a></td><td>Send a <code>DELETE</code> request.</td></tr><tr><td><a href="#remotemet-hod-url-options-callback"><code>remote</code></a></td><td>The HTTP request method that powers other request methods.</td></tr><tr><td><a href="#parsequery-query"><code>parseQuery</code></a></td><td>Parses a URL query string, returning an object of parameters.</td></tr><tr><td><a href="#addquerytourl-url-data"><code>addQueryToUrl</code></a></td><td>Returns a URL with data object properties added as a query string.</td></tr></tbody></table><h3 id="get-url-options-callback" tabindex="-1"><code>get(url, options, callback)</code> <a class="header-anchor" href="#get-url-options-callback" aria-label="Permalink to &quot;\`get(url, options, callback)\`&quot;">​</a></h3><p>Send a <code>GET</code> request. The response will be returned via a Promise unless a callback is included. Query string data may be in <code>options.qs</code>. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>url</code></td><td>The path to a resource or service</td></tr><tr><td><code>options</code></td><td>Request options. See <a href="#remote-method-url-options-callback"><code>apos.http.remote</code></a> for details.</td></tr><tr><td><code>callback</code></td><td>An optional callback function, required when not using Promises. Receives <code>error</code> and <code>result</code> arguments.</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">async</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">logArticles</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">articles</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">try</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">articles</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">await</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">get</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">/api/v1/article</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">info</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">articles</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">catch</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">error</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">err</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">logArticles</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span></code></pre></div><h3 id="post-url-options-callback" tabindex="-1"><code>post(url, options, callback)</code> <a class="header-anchor" href="#post-url-options-callback" aria-label="Permalink to &quot;\`post(url, options, callback)\`&quot;">​</a></h3><p>Send a <code>POST</code> request. The response will be returned via a Promise unless a callback is included. <code>options.body</code> should be an object containing properties to be passed as <code>POST</code> body data. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><p>See <a href="#get-url-options-callback">the <code>get</code> method</a> for argument details and a related example.</p><h3 id="patch-url-options-callback" tabindex="-1"><code>patch(url, options, callback)</code> <a class="header-anchor" href="#patch-url-options-callback" aria-label="Permalink to &quot;\`patch(url, options, callback)\`&quot;">​</a></h3><p>Send a <code>PATCH</code> request. The response will be returned via a Promise unless a callback is included. <code>PATCH</code> body data should be in <code>options.body</code>. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><p>See <a href="#get-url-options-callback">the <code>get</code> method</a> for argument details and a related example.</p><h3 id="put-url-options-callback" tabindex="-1"><code>put(url, options, callback)</code> <a class="header-anchor" href="#put-url-options-callback" aria-label="Permalink to &quot;\`put(url, options, callback)\`&quot;">​</a></h3><p>Send a <code>PUT</code> request. The response will be returned via a Promise unless a callback is included. <code>PUT</code> body data should be in <code>options.body</code>. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><p>See <a href="#get-url-options-callback">the <code>get</code> method</a> for argument details and a related example.</p><h3 id="delete-url-options-callback" tabindex="-1"><code>delete(url, options, callback)</code> <a class="header-anchor" href="#delete-url-options-callback" aria-label="Permalink to &quot;\`delete(url, options, callback)\`&quot;">​</a></h3><p>Send a <code>DELETE</code> request. The response will be returned via a Promise unless a callback is included. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><p>See <a href="#get-url-options-callback">the <code>get</code> method</a> for argument details and a related example.</p><h3 id="remote-method-url-options-callback" tabindex="-1"><code>remote(method, url, options, callback)</code> <a class="header-anchor" href="#remote-method-url-options-callback" aria-label="Permalink to &quot;\`remote(method, url, options, callback)\`&quot;">​</a></h3><p>Send an HTTP request with a specific method to the given URL, returning the response body. The response will be returned via a Promise unless a callback is included. You do NOT have to pass a callback unless you must support IE11 and do not otherwise have Promise support.</p><div class="info custom-block"><p class="custom-block-title">INFO</p><p><strong>This method is used to power the individual HTTP request methods. We recommend using those instead.</strong> They will produce the same result as using <code>remote</code> and including the proper HTTP method name.</p></div><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>method</code></td><td>An HTTP method name: <code>GET</code>, <code>POST</code>, <code>PUT</code>, <code>PATCH</code>, or <code>DELETE</code></td></tr><tr><td><code>url</code></td><td>The path to a resource or service</td></tr><tr><td><code>options</code></td><td>Request options. See below.</td></tr><tr><td><code>callback</code></td><td>An optional callback function receiving when not using Promises. Receives <code>error</code> and <code>result</code> arguments.</td></tr></tbody></table><table><thead><tr><th>Options</th><th>What is it?</th></tr></thead><tbody><tr><td><code>qs</code></td><td>An object of query string parameters set to values.</td></tr><tr><td><code>body</code></td><td>The request body. If an object or array it is sent as JSON. Otherwise sent as-is, unless the <code>send</code> option is set to <code>&#39;json&#39;</code>.</td></tr><tr><td><code>send</code></td><td>Set to <code>&#39;json&#39;</code> to <em>always</em> send the request body as JSON, even if a <a href="https://www.npmjs.com/package/form-data" target="_blank" rel="noreferrer"><code>FormData</code> object</a> or non-object. This is not necessary when the body is a normal object.</td></tr><tr><td><code>parse</code></td><td>Set to <code>&#39;json&#39;</code> to <em>always</em> parse the response as JSON. Otherwise the response body is parsed as JSON only if the <code>Content-Type</code> is <code>application/json</code>.</td></tr><tr><td><code>headers</code></td><td>An object containing HTTP header names and values.</td></tr><tr><td><code>draft</code></td><td>If <code>true</code>, always add <code>aposMode=draft</code> to the query string, creating one if needed.</td></tr><tr><td><code>csrf</code></td><td>Set to <code>false</code> to prevent sending the <code>X-XSRF-TOKEN</code> header when talking to the same site.</td></tr><tr><td><code>fullResponse</code></td><td>If <code>true</code>, return an object with <code>status</code>, <code>headers</code> and <code>body</code> properties, rather than returning the body directly. The individual <code>headers</code> are canonicalized to lowercase names. If there are duplicate headers after canonicalizing only the last value is returned. If a header appears multiple times an array is returned for it.</td></tr><tr><td><code>downloadProgress</code></td><td>Optional. A function accepting <code>received</code> and <code>total</code> arguments. It may never be called. If called, <code>received</code> will be the bytes sent so far and <code>total</code> will be the total bytes to be received. If the total is unknown, it will be <code>null</code></td></tr><tr><td><code>uploadProgress</code></td><td>Optional. A function accepting <code>sent</code> and <code>total</code> arguments. It may never be called. If it is called, <code>sent</code> will be the bytes sent so far and <code>total</code> will be the total bytes to be sent. If the total is unknown, it will be <code>null</code>.</td></tr></tbody></table><p>If the status code is greater than 400 an error is thrown. The error object will be similar to a <code>fullResponse</code> object, with a <code>status</code> property.</p><p>If the URL is site-relative (starts with <code>/</code>) it will be requested from the Apostrophe site itself.</p><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Just before the <code>XMLHttpRequest</code> is sent, this method emits an event matching the HTTP method. For example, <code>apos-before-post</code> for <code>POST</code> requests, <code>apos-before-get</code> for <code>GET</code> requests, etc. The event object has <code>uri</code>, <code>data</code> and <code>request</code> properties. <code>request</code> is the <code>XMLHttpRequest</code> object.</p><p>You can use this to set custom headers on all requests, for example.</p></div><h3 id="parsequery-query" tabindex="-1"><code>parseQuery(query)</code> <a class="header-anchor" href="#parsequery-query" aria-label="Permalink to &quot;\`parseQuery(query)\`&quot;">​</a></h3><p>Returns a data object from parsing a URL query string (e.g., <code>?theme=light&amp;aposRefresh=1</code>). The argument should only include the query string part of a URL. The leading question mark (<code>?</code>) is allowed but not required. A parameter with no value will be set to <code>null</code>.</p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>query</code></td><td>A url query string</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> simpleParams </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parseQuery</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?refresh=true&amp;number=7</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> nestedParams </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">parseQuery</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">?product%5Bprice%5D=50&amp;product%5Bname%5D=Cheese</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><div class="info custom-block"><p class="custom-block-title">INFO</p><p><code>apos.http.parseQuery()</code> supports query parameter objects and arrays (when escaped), as well as bracket nesting.</p></div><h3 id="addquerytourl-url-data" tabindex="-1"><code>addQueryToUrl(url, data)</code> <a class="header-anchor" href="#addquerytourl-url-data" aria-label="Permalink to &quot;\`addQueryToUrl(url, data)\`&quot;">​</a></h3><p>Returns a URL with data object properties added as a query string. This supports data object values as objects and arrays. If <code>data</code> is an empty object no query string is added. <strong>If the URL already includes a query string it is discarded and replaced.</strong></p><table><thead><tr><th>Argument</th><th>What is it?</th></tr></thead><tbody><tr><td><code>url</code></td><td>A url</td></tr><tr><td><code>data</code></td><td>An object with data to convert to a query string</td></tr></tbody></table><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> updatedUrl </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> apos</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">http</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addQueryToUrl</span><span style="color:#A6ACCD;">(location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">href</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">theme</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dark</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">search-complete</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span></code></pre></div>`,80),l=[n];function r(p,c,d,i,h,y){return s(),a("div",null,l)}const F=e(o,[["render",r]]);export{D as __pageData,F as default};
